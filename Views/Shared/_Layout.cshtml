@* Views/Shared/_Layout.cshtml *@
@{
    Layout = null;
    var currentController = (string?)ViewContext.RouteData.Values["controller"] ?? "";
    var currentAction = (string?)ViewContext.RouteData.Values["action"] ?? "";
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@(string.IsNullOrWhiteSpace(ViewData["Title"] as string) ? "web_cv" : ViewData["Title"] + " - web_cv")</title>

    <script type="importmap"></script>

    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />

    <!-- Bootstrap Icons (theo yêu cầu) -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" 
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/web_cv.styles.css" asp-append-version="true" />
    <style>
      /* Minimal visual polish — unify brand color usage */
      .btn-primary{color:#fff;background-color:var(--primary-color);border-color:var(--primary-color)}
      .btn-primary:hover,.btn-primary:focus{filter:brightness(.96);color:#fff;box-shadow:0 6px 16px rgba(30,111,255,.25)}

      .navstrip .navbar-nav .nav-link{position:relative}
      .navstrip .navbar-nav .nav-link::after{content:"";position:absolute;left:.35rem;right:.35rem;bottom:.35rem;height:2px;background:var(--primary-color);transform-origin:left;transform:scaleX(0);transition:transform .18s ease}
      .navstrip .navbar-nav .nav-link:hover{color:var(--primary-color)!important}
      .navstrip .navbar-nav .nav-link:hover::after{transform:scaleX(1)}
      .navstrip .navbar-nav .nav-link.active{color:var(--primary-color)!important;font-weight:700}
      .navstrip .navbar-nav .nav-link.active::after{transform:scaleX(1)}

      .nav-item.dropdown .dropdown-item:hover{color:var(--primary-color)!important}
      .nav-item.dropdown .dropdown-item.active{background:var(--primary-color)!important;color:#fff!important}
      .nav-item.dropdown .dropdown-toggle:hover{color:var(--primary-color)!important}
    </style>
    @await RenderSectionAsync("Styles", required: false)
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap&subset=vietnamese" rel="stylesheet">\n</head>
<body class="d-flex flex-column min-vh-100">

    <!-- HEADER (topbar + navbar) -->
    <partial name="_Header" />

    <!-- PAGE CONTENT -->
    @* Trang chủ full-bleed; các trang khác bọc container *@
    <main id="main" role="main" class="flex-grow-1 page-container">
        @if (currentController == "Home" && currentAction == "Index")
        {
            @RenderBody()
        }
        else
        {
            <div class="container py-3">
                @RenderBody()
            </div>
        }
    </main>

    <!-- FOOTER -->
    <partial name="_Footer" />

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script>
    // Dynamic admin badges (runs safely on all pages; no-op outside Admin)
    (function(){
      async function refreshBadges(){
        try{
          const res = await fetch('/Admin/Dashboard/RecentActivities?take=6', { cache:'no-store' });
          if(!res.ok) return;
          const data = await res.json();
          var b = document.getElementById('notifBellCount');
          var m = document.getElementById('notifMailCount');
          if(b) b.textContent = (data.bellCount ?? (data.activities||[]).length).toString();
          if(m) m.textContent = (data.mailCount ?? 0).toString();
        }catch(e){}
      }
      refreshBadges();
      setInterval(refreshBadges, 30000);
    })();
    </script>
    @await RenderSectionAsync("Scripts", required: false)

    <!-- Back to top button -->
    <button id="backToTop" class="back-to-top" aria-label="Lên đầu trang" title="Lên đầu trang">
        <i class="bi bi-arrow-up-short"></i>
    </button>
</body>
</html>

