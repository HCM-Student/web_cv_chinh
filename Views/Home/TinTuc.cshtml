@using WEB_CV.Models
@model List<BaiViet>
@{
    ViewData["Title"] = "Tin t·ª©c - S·ª± ki·ªán";
}

@section Styles {
    <link rel="stylesheet" href="~/css/news-hero.css" asp-append-version="true" />
}

<!-- ===================== TIN T·ª®C HERO ===================== -->
<section class="news-hero">
    <div class="news-bg">
        <div class="news-overlay"></div>
        
        <!-- Floating Elements -->
        <div class="floating-elements">
            <div class="floating-icon" style="font-size: 3rem;"><i class="fas fa-newspaper"></i></div>
            <div class="floating-icon" style="font-size: 2.5rem;"><i class="fas fa-calendar-alt"></i></div>
            <div class="floating-icon" style="font-size: 3.5rem;"><i class="fas fa-bullhorn"></i></div>
            <div class="floating-icon" style="font-size: 2rem;"><i class="fas fa-globe"></i></div>
            <div class="floating-icon" style="font-size: 2.8rem;"><i class="fas fa-trending-up"></i></div>
        </div>
        
        <div class="container position-relative" style="z-index: 15;">
            <div class="row align-items-center py-5">
                <div class="col-lg-10 mx-auto">
                    <div class="news-content-wrapper">
                        <div class="news-content">
                            <span class="eyebrow text-white-50 mb-3 d-block">üì∞ C·∫≠p nh·∫≠t th∆∞·ªùng xuy√™n</span>
                            <h1 class="news-title display-4 fw-bold text-white mb-4">Tin t·ª©c - S·ª± ki·ªán</h1>
                            <p class="text-white-75 fs-5 mb-4">Theo d√µi nh·ªØng tin t·ª©c m·ªõi nh·∫•t, s·ª± ki·ªán v√† xu h∆∞·ªõng c√¥ng ngh·ªá trong lƒ©nh v·ª±c GIS</p>
                            <div class="hero-buttons mt-4">
                                <a href="#news-container" class="btn btn-light btn-lg me-3">
                                    <i class="fas fa-list me-2"></i>Xem tin t·ª©c
                                </a>
                                <a href="@Url.Action("LienHe", "Home")" class="btn btn-outline-light btn-lg">
                                    <i class="fas fa-envelope me-2"></i>Li√™n h·ªá
                                </a>
                            </div>
                        </div>
                        
                        <!-- Stats Section -->
                        <div class="news-stats-section">
                            <div class="row">
                                <div class="col-lg-3 col-6">
                                    <div class="stat-item">
                                        <span class="stat-number">@(Model?.Count ?? 0)</span>
                                        <span class="stat-label">B√†i vi·∫øt m·ªõi</span>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-6">
                                    <div class="stat-item">
                                        <span class="stat-number">24/7</span>
                                        <span class="stat-label">C·∫≠p nh·∫≠t</span>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-6">
                                    <div class="stat-item">
                                        <span class="stat-number">100%</span>
                                        <span class="stat-label">Tin c·∫≠y</span>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-6">
                                    <div class="stat-item">
                                        <span class="stat-number">GIS</span>
                                        <span class="stat-label">Chuy√™n ng√†nh</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- ===================== B·ªò L·ªåC TIN T·ª®C ===================== -->
<section class="section bg-light">
    <div class="container">
        <div class="row">
            <div class="col-lg-3">
                <div class="news-sidebar sticky-top" style="top: 90px;">
                    <h5 class="sidebar-title">B·ªô l·ªçc</h5>
                    
                    <div class="filter-group">
                        <h6>Chuy√™n m·ª•c</h6>
                        <div class="filter-options">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="all" checked>
                                <label class="form-check-label" for="all">T·∫•t c·∫£</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="tin-tuc">
                                <label class="form-check-label" for="tin-tuc">Tin t·ª©c</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="su-kien">
                                <label class="form-check-label" for="su-kien">S·ª± ki·ªán</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="cong-nghe">
                                <label class="form-check-label" for="cong-nghe">C√¥ng ngh·ªá</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="filter-group">
                        <h6>Th·ªùi gian</h6>
                        <select class="form-select">
                            <option value="">T·∫•t c·∫£</option>
                            <option value="7">7 ng√†y qua</option>
                            <option value="30">30 ng√†y qua</option>
                            <option value="90">3 th√°ng qua</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <h6>T√¨m ki·∫øm</h6>
                        <div class="search-box">
                            <input type="text" class="form-control" placeholder="Nh·∫≠p t·ª´ kh√≥a...">
                            <button class="btn btn-primary btn-sm" type="button">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-9">
                @if (Model?.Any() == true)
                {
                    <!-- ===================== B√ÄI VI·∫æT N·ªîI B·∫¨T ===================== -->
                    @if (Model.Count > 0)
                    {
                        var featuredPost = Model.First();
                        <div class="featured-post mb-5">
                            <div class="row g-0">
                                <div class="col-md-6">
                                    <div class="featured-image">
                                                                <img src="~/img/hero/hero-1.jpg" alt="@featuredPost.TieuDe" class="img-fluid">
                                        <div class="featured-badge">N·ªïi b·∫≠t</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="featured-content">
                                        <div class="post-meta">
                                            <span class="category">@featuredPost.ChuyenMuc?.Ten</span>
                                            <span class="date">@featuredPost.NgayDang.ToString("dd/MM/yyyy")</span>
                                        </div>
                                        <h3 class="featured-title">
                                            <a href="@Url.Action("ChiTietBaiViet", "Home", new { id = featuredPost.Id })">
                                                @featuredPost.TieuDe
                                            </a>
                                        </h3>
                                        <p class="featured-excerpt">@(featuredPost.TomTat ?? (featuredPost.NoiDung.Length > 200 ? featuredPost.NoiDung.Substring(0, 200) + "..." : featuredPost.NoiDung))</p>
                                        <a href="@Url.Action("ChiTietBaiViet", "Home", new { id = featuredPost.Id })" class="btn btn-primary">
                                            ƒê·ªçc th√™m <i class="fas fa-arrow-right ms-1"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                    
                    <!-- ===================== DANH S√ÅCH B√ÄI VI·∫æT ===================== -->
                    <div class="news-grid">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h4>Tin t·ª©c m·ªõi nh·∫•t</h4>
                            <div class="d-flex align-items-center gap-2">
                                <select id="sortSelect" class="form-select form-select-sm w-auto">
                                    <option value="newest">M·ªõi nh·∫•t</option>
                                    <option value="oldest">C≈© nh·∫•t</option>
                                    <option value="title">Theo ti√™u ƒë·ªÅ (A-Z)</option>
                                </select>
                                <div class="view-options">
                                <button class="btn btn-sm btn-outline-primary active" data-view="grid" title="L∆∞·ªõi">
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-primary" data-view="list" title="Danh s√°ch">
                                    <i class="fas fa-list"></i>
                                </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row g-4" id="news-container">
                            @foreach (var baiViet in Model.Skip(1)) // B·ªè qua b√†i ƒë·∫ßu ti√™n ƒë√£ hi·ªÉn th·ªã featured
                            {
                                <div class="col-lg-4 col-md-6 news-item">
                                    <div class="news-card">
                                        <div class="news-image">
                                            <img src="~/img/hero/hero-2.jpg" alt="@baiViet.TieuDe" class="img-fluid">
                                            <div class="news-category">@baiViet.ChuyenMuc?.Ten</div>
                                        </div>
                                        <div class="news-content">
                                            <div class="news-meta">
                                                <span class="news-date">
                                                    <i class="fas fa-calendar me-1"></i>
                                                    @baiViet.NgayDang.ToString("dd/MM/yyyy")
                                                </span>
                                                <span class="news-author">
                                                    <i class="fas fa-user me-1"></i>
                                                    @(baiViet.TacGia?.HoTen ?? "Admin")
                                                </span>
                                            </div>
                                            <h5 class="news-title">
                                                <a href="@Url.Action("ChiTietBaiViet", "Home", new { id = baiViet.Id })">
                                                    @baiViet.TieuDe
                                                </a>
                                            </h5>
                                            <p class="news-excerpt">
                                                @(baiViet.TomTat ?? (baiViet.NoiDung.Length > 120 ? baiViet.NoiDung.Substring(0, 120) + "..." : baiViet.NoiDung))
                                            </p>
                                            <div class="news-footer">
                                                <a href="@Url.Action("ChiTietBaiViet", "Home", new { id = baiViet.Id })" class="read-more">
                                                    ƒê·ªçc th√™m <i class="fas fa-arrow-right"></i>
                                                </a>
                                                @if (baiViet.BaiVietTags?.Any() == true)
                                                {
                                                    <div class="news-tags">
                                                        @foreach (var baiVietTag in baiViet.BaiVietTags.Take(2))
                                                        {
                                                            <span class="tag">#@baiVietTag.Tag?.Ten</span>
                                                        }
                                                    </div>
                                                }
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                    
                    <!-- ===================== PH√ÇN TRANG ===================== -->
                    <div class="pagination-wrapper text-center mt-5">
                        <nav aria-label="Ph√¢n trang tin t·ª©c">
                            <ul class="pagination justify-content-center">
                                <li class="page-item disabled">
                                    <a class="page-link" href="#" aria-label="Trang tr∆∞·ªõc">
                                        <i class="fas fa-chevron-left"></i>
                                    </a>
                                </li>
                                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                <li class="page-item"><a class="page-link" href="#">2</a></li>
                                <li class="page-item"><a class="page-link" href="#">3</a></li>
                                <li class="page-item">
                                    <a class="page-link" href="#" aria-label="Trang sau">
                                        <i class="fas fa-chevron-right"></i>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                }
                else
                {
                    <!-- ===================== KH√îNG C√ì B√ÄI VI·∫æT ===================== -->
                    <div class="no-posts text-center py-5">
                        <div class="no-posts-icon mb-4">
                            <i class="fas fa-newspaper fa-4x text-muted"></i>
                        </div>
                        <h4 class="text-muted">Ch∆∞a c√≥ b√†i vi·∫øt n√†o</h4>
                        <p class="text-muted">Hi·ªán t·∫°i ch∆∞a c√≥ b√†i vi·∫øt n√†o ƒë∆∞·ª£c ƒëƒÉng. Vui l√≤ng quay l·∫°i sau.</p>
                        <a href="@Url.Action("Index", "Home")" class="btn btn-primary">
                            <i class="fas fa-home me-2"></i>V·ªÅ trang ch·ªß
                        </a>
                    </div>
                }
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        (function(){
            const container = document.getElementById('news-container');
            const toggleBtns = document.querySelectorAll('.view-options [data-view]');

            toggleBtns.forEach(btn => {
                btn.addEventListener('click', function(){
                    toggleBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');

                    const view = this.getAttribute('data-view');
                    if(view === 'list'){
                        container.classList.add('list-view');
                        document.querySelectorAll('#news-container .news-item').forEach(col => {
                            col.classList.remove('col-lg-4','col-md-6');
                            col.classList.add('col-12');
                        });
                    } else {
                        container.classList.remove('list-view');
                        document.querySelectorAll('#news-container .news-item').forEach(col => {
                            col.classList.add('col-lg-4','col-md-6');
                            col.classList.remove('col-12');
                        });
                    }
                });
            });

            // Basic client-side sort (by date text or title)
            const sortSelect = document.getElementById('sortSelect');
            if (sortSelect){
                sortSelect.addEventListener('change', function(){
                    const items = Array.from(container.children);
                    const val = this.value;
                    items.sort((a,b)=>{
                        const getDate = el => new Date(el.querySelector('.news-date')?.textContent.trim().split(/\s+/).pop().split('/').reverse().join('-'));
                        const getTitle = el => (el.querySelector('.news-title a')?.textContent || '').toLowerCase();
                        if(val==='oldest') return getDate(a)-getDate(b);
                        if(val==='title') return getTitle(a).localeCompare(getTitle(b));
                        return getDate(b)-getDate(a);
                    });
                    items.forEach(el=>container.appendChild(el));
                });
            }
        })();
    </script>
}

<!-- ===================== NEWSLETTER SIGNUP ===================== -->
<section class="section newsletter-section">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 text-center">
                <div class="newsletter-content">
                    <h3 class="newsletter-title">ƒêƒÉng k√Ω nh·∫≠n tin t·ª©c</h3>
                    <p class="newsletter-desc">Nh·∫≠n th√¥ng tin c·∫≠p nh·∫≠t m·ªõi nh·∫•t v·ªÅ c√¥ng ngh·ªá GIS v√† c√°c s·ª± ki·ªán s·∫Øp t·ªõi</p>
                    <form class="newsletter-form">
                        <div class="input-group">
                            <input type="email" class="form-control" placeholder="Nh·∫≠p email c·ªßa b·∫°n...">
                            <button class="btn btn-primary" type="submit">
                                <i class="fas fa-paper-plane me-2"></i>ƒêƒÉng k√Ω
                            </button>
                        </div>
                        <small class="form-text text-muted mt-2">
                            Ch√∫ng t√¥i cam k·∫øt b·∫£o m·∫≠t th√¥ng tin c√° nh√¢n c·ªßa b·∫°n
                        </small>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>
